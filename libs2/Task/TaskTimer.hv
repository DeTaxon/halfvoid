
TaskTimersMutex := Mutex^
TaskTimersArray := List.{Tuple.{double,Task^}}

TSleep := !(double val) -> void
{
	endTime := GetSteadyTime() + val
	TaskCheckMutex.Lock()
	TaskLoopWorkCounter += 1
	val2 := !{endTime,CurrentTask}

	TaskTimersArray.SortedPush(val2)
	val2.1 = null //TODO  make SortedPush(!{endTime,CurrentTask}), but garbage collection is not working for tuples
	if someoneOnLoop
		TaskSleepConVar.Notify()
	CurrentThread.ThreadMainTask.switchToTask()
	TaskCheckMutex.Unlock()
}
