

UVLoop := class extend TGCObject
{
	loopData := u8[0]
	Destroy := virtual !() -> void
	{
		uv_loop_close(loopData[0]&)
	}
	GetPointer := !() -> u8^
	{
		return loopData[0]&
	}
}

uvLoopGlobal := UVLoop^
createUVLoop := !() -> void
{
	if uvLoopGlobal != null
		return void

	libUVInit()
	uvLoopGlobal = malloc(UVLoop->TypeSize + uv_loop_size())->{UVLoop^}
	uv_loop_init(uvLoopGlobal.GetPointer())
}
